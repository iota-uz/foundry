<!doctype html>
<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

{% seo %}
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
    <script src="{{ '/assets/js/respond.js' | relative_url }}"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="{{ '/assets/css/ie.css' | relative_url }}">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!-- Mermaid.js for diagram rendering -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    {% include head-custom.html %}
  </head>
  <body class="gradient-bg">
      <div id="header">
        <nav>
          <ul>
            <li>
              <button class="search-trigger" id="search-trigger" type="button" aria-label="Search documentation">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/>
                </svg>
                <span>Search</span>
                <kbd>âŒ˜K</kbd>
              </button>
            </li>
            <li class="fork"><a href="{{ site.github.repository_url }}">View On GitHub</a></li>
            {% if site.show_downloads %}
              <li class="downloads"><a href="{{ site.github.zip_url }}">ZIP</a></li>
              <li class="downloads"><a href="{{ site.github.tar_url }}">TAR</a></li>
              <li class="title">DOWNLOADS</li>
            {% endif %}
          </ul>
        </nav>
      </div><!-- end header -->

    <div class="wrapper-with-sidebar">
      {% include sidebar.html %}

      <section class="main-content">
        <div id="title">
          <div class="title-row">
            <h1>{{ page.title | default: site.title | default: site.github.repository_name }}</h1>
            <button class="copy-page-button" aria-label="Copy page as markdown" title="Copy page as markdown">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
              <span>Copy page</span>
            </button>
          </div>
          {% if page.description %}
          <p>{{ page.description }}</p>
          {% elsif page.url == "/" %}
          <p>{{ site.tagline | default: site.description | default: site.github.project_tagline }}</p>
          {% endif %}
          <hr>
        </div>

        {{ content }}

        <footer>
          <span class="credits left">Project maintained by <a href="{{ site.github.owner_url }}">{{ site.github.owner_name }}</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/mattgraham">mattgraham</a></span>
        </footer>
      </section>

      {% include toc.html %}
    </div>

    {% include search-modal.html %}

    <script>
      // Initialize Mermaid with shadcn/ui-inspired dark theme
      mermaid.initialize({
        startOnLoad: false,
        theme: 'dark',
        themeVariables: {
          primaryColor: '#27272a',
          primaryTextColor: '#fafafa',
          primaryBorderColor: '#8b5cf6',
          lineColor: '#8b5cf6',
          secondaryColor: '#18181b',
          tertiaryColor: '#27272a',
          background: '#09090b',
          mainBkg: '#27272a',
          nodeBorder: '#8b5cf6',
          clusterBkg: '#18181b',
          clusterBorder: '#27272a',
          titleColor: '#fafafa',
          edgeLabelBackground: '#18181b'
        }
      });

      document.addEventListener('DOMContentLoaded', function() {
        // Convert markdown mermaid code blocks to mermaid divs
        var mermaidBlocks = document.querySelectorAll('code.language-mermaid');
        mermaidBlocks.forEach(function(codeBlock) {
          var pre = codeBlock.parentElement;
          var mermaidDiv = document.createElement('div');
          mermaidDiv.className = 'mermaid';
          mermaidDiv.textContent = codeBlock.textContent;
          pre.parentNode.replaceChild(mermaidDiv, pre);
        });

        // Now render all mermaid diagrams
        if (mermaidBlocks.length > 0) {
          mermaid.run();
        }

        // Toggle sidebar on mobile
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('.sidebar');
        if (toggle && sidebar) {
          toggle.addEventListener('click', function() {
            sidebar.classList.toggle('open');
          });
        }

        // Collapsible navigation groups
        var toggleButtons = document.querySelectorAll('.nav-group-toggle');
        toggleButtons.forEach(function(button) {
          button.addEventListener('click', function() {
            var group = this.closest('.nav-group');
            var isOpen = group.classList.contains('open');

            // Toggle the clicked group
            group.classList.toggle('open');
            this.setAttribute('aria-expanded', !isOpen);
          });
        });

        // Ensure active section is visible on page load
        var activeItem = document.querySelector('.nav-children .nav-item.active');
        if (activeItem) {
          var parentGroup = activeItem.closest('.nav-group');
          if (parentGroup && !parentGroup.classList.contains('open')) {
            parentGroup.classList.add('open');
            var toggleBtn = parentGroup.querySelector('.nav-group-toggle');
            if (toggleBtn) {
              toggleBtn.setAttribute('aria-expanded', 'true');
            }
          }
        }
      });
    </script>

    <!-- Feature scripts -->
    <script src="{{ '/assets/js/copy-code.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/toc.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/search.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/copy-page.js' | relative_url }}"></script>
  </body>
</html>
